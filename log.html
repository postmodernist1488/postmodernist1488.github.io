<!DOCTYPE html>

<html>
<head>
<link href="style.css" rel="stylesheet"/>
<title>postmodernist1848 personal website</title>
<link href="/assets/favicon.ico" rel="icon" type="image/x-icon"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<script src="index.js"></script>
</head>
<body>
<div class="checkbox-with-text" id="sidebar-checkbox-with-text" style="position: fixed; top: 0; margin: 20px">
<label id="sidebar-toggle-label"><input id="sidebar-toggle" type="checkbox"/>hide sidebar</label>
</div>
<div class="sidebar" id="sidebar">
<div id="my-websit">my websit</div>
<a class="" href="/index.html" style="background-color: #81a1c1">int main</a>
<a class="" href="/funi.html" style="background-color: #a3be8c">funi</a>
<a class="" href="/game.html" style="background-color: #ebcb8b">game</a>
<a class="current" href="/log.html" style="background-color: #f59335">log</a>
<a href="/links.html" style="background-color: #bf616a">links</a>
<fieldset style="height: 10%">
<legend style="font-size: 0.5em; color: white">Funi stuff</legend>
<div class="checkbox-with-text">
<label>
<input id="rainbow-toggle" type="checkbox"/>rainbow</label>
</div>
</fieldset>
</div>
<div id="contents"><div id="hint">HINT: You can tap the dates to show/hide notes.</div>
<div id="paste">
<h1 id="loading-message">Loading</h1>
</div>
<script>
    //TODO: create my own cors proxy
    const url = 'https://api.allorigins.win/raw?url=https://pastebin.com/raw/vb43aqyz'
    //fetch('https://pastebin.com/raw/vb43aqyz')
    fetch(url)
    .then(response => response.ok ? response.text(): 'error, sorry')
    .then(html => {
        document.getElementById('paste').innerHTML = html;
        const rainbow_checkbox = document.getElementById('rainbow-toggle');
        if (rainbow_checkbox.checked) {
            initial_state.clear()
            rainbowize_contents()
        }
        const h5s = document.getElementsByTagName('h5');

        let currentH5 = h5s[0];
        let currentNode = currentH5.nextSibling;
        let divWrapper = document.createElement('div');

        while (currentNode !== null) {
            const nextNode = currentNode.nextSibling;

            if (currentNode.tagName === "H5") {
                currentH5.insertAdjacentElement('afterend', divWrapper);
                currentH5 = currentNode;
                divWrapper = document.createElement('div');
            } else {
                divWrapper.appendChild(currentNode);
            }
            currentNode = nextNode;
        }
        currentH5.insertAdjacentElement('afterend', divWrapper);

        for (let i = 0; i < h5s.length; i++) {
            // show the last one
            h5s[i].nextElementSibling.classList.add('notes');
            if (i != h5s.length - 1) {
                h5s[i].nextElementSibling.classList.add('hidden');
            }
            h5s[i].addEventListener("click", function() {
                var content = this.nextElementSibling;
                content.classList.toggle('hidden');
            });
        }
    }).catch((e) => {
        console.log(e)
        document.getElementById('loading-message').innerHTML = 
            'Error. Try refreshing the page'
    })
</script>
</div>
<footer>
            Copyright <a href="https://github.com/postmodernist1848">postmodernist1848</a>
</footer>
</body>
</html>
