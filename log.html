<!DOCTYPE html>

<html>
<head>
<link href="style.css" rel="stylesheet"/>
<title>postmodernist1848 personal website</title>
<link href="/assets/favicon.ico" rel="icon" type="image/x-icon"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<script src="index.js"></script>
</head>
<body>
<div class="checkbox-with-text" id="sidebar-checkbox-with-text" style="position: fixed; top: 0; margin: 20px">
<label id="sidebar-toggle-label"><input id="sidebar-toggle" type="checkbox"/>hide sidebar</label>
</div>
<div class="sidebar" id="sidebar">
<div id="my-websit">my websit</div>
<a class="" href="/index.html" style="background-color: #81a1c1">int main</a>
<a class="" href="/funi.html" style="background-color: #a3be8c">funi</a>
<a class="" href="/game.html" style="background-color: #ebcb8b">game</a>
<a class="current" href="/log.html" style="background-color: #f59335">log</a>
<a href="/link.html" style="background-color: #bf616a">link</a>
<fieldset style="height: 10%">
<legend style="font-size: 0.5em; color: white">Funi stuff</legend>
<div class="checkbox-with-text">
<label>
<input id="rainbow-toggle" type="checkbox"/>rainbow</label>
</div>
</fieldset>
</div>
<div id="contents"><div id="paste">
<h1 id="loading-message">Loading</h1>
</div>
<script>
    //TODO: create my own cors proxy
    const url = 'https://api.allorigins.win/raw?url=https://pastebin.com/raw/vb43aqyz'
    //fetch('https://pastebin.com/raw/vb43aqyz')
    fetch(url)
    .then(response => response.ok ? response.text(): 'error, sorry')
    .then(html => {
        document.getElementById('paste').innerHTML = html;
        const rainbow_checkbox = document.getElementById('rainbow-toggle');
        if (rainbow_checkbox.checked) {
            initial_state.clear()
            rainbowize_contents()
        }
        var h5s = document.getElementsByTagName('h5');
        console.log(h5s)
        for (let i = 0; i < h5s.length - 1; i++) {
            const divWrapper = document.createElement('div');
            let startElement = h5s[i];
            let currentElement = startElement.nextSibling;
            let endElement = h5s[i + 1]
            while (currentElement !== endElement) {
                const nextElement = currentElement.nextSibling;
                divWrapper.appendChild(currentElement);
                currentElement = nextElement;
            }
            startElement.insertAdjacentElement('afterend', divWrapper);
        }

        // last one
        let currentElement = h5s[h5s.length - 1].nextSibling;
        const divWrapper = document.createElement('div');
        console.log(currentElement)
        while (currentElement !== null) {
            console.log(currentElement)
            const nextElement = currentElement.nextSibling;
            divWrapper.appendChild(currentElement);
            currentElement = nextElement;
        }
        h5s[h5s.length - 1].insertAdjacentElement('afterend', divWrapper);


        for (i = 0; i < h5s.length; i++) {
            h5s[i].addEventListener("click", function() {
                var content = this.nextElementSibling;
                if (content.style.display !== "none") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            });
        }
    }).catch((e) => {
        console.log(e)
        document.getElementById('loading-message').innerHTML = 
            'Error. Try refreshing the page'
    })
</script>
</div>
<footer>
            Copyright <a href="https://github.com/postmodernist1848">postmodernist1848</a>
</footer>
</body>
</html>
